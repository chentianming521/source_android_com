<!DOCTYPE html>











































































































<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<meta name="Description" content="Trusty is a set of software components supporting a Trusted Execution Environment (TEE) on mobile devices. Trusty consists of: Important : Trusty and the Trusty API are subject to change. For information about the Trusty API, see the API Reference . Anyâ€¦">

<link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<title>Trusty TEE | Android Open Source Project</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="https://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="../../assets/css/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="https://www.google.com/jsapi" type="text/javascript"></script>
<script src="../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "/";
  
  var devsite = false;
  
</script>
<script src="../../assets/js/docs.js" type="text/javascript"></script>


<script type="text/javascript" src="https://www.gstatic.com/feedback/api.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45455297-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body class="gc-documentation 
  " itemscope itemtype="http://schema.org/Article">
<a name="top"></a>

  
    <!-- Header -->
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 saclogo">
          <a href="../../index.html">
            <img src="../../assets/images/sac_logo.png"
                srcset="/assets/images/sac_logo@2x.png 2x"
                width="123" height="25" alt="Android Open Source Project" />
          </a>
          </div>
            <ul class="nav-x col-9">
                <li class="source">
                  <a href="../../source/index.html" 
                  >Source</a></li>
                <li class="devices"><a href="../../devices/index.html" 
                  >Devices</a></li>
                <li class="security"><a href="../index.html" class="selected"
                  >Security</a></li>
                <li class="compatibility last"><a href="../../compatibility/index.html" 
                  >Compatibility</a></li>
            </ul>
            <!-- New Search -->
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Android Sites</div>
      <ul>
        <li class="active"><a>Android Open Source Project</a></li>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li><a href="http://developer.android.com">Android Developers</a></li>
      </ul>
      <!-- <div class="header">Support</div>
      <ul>
        <li><a href="/support.html">Developer Support</a></li>
      </ul> -->
      <br class="clearfix" />
    </div>
    <div class="bottom"></div>
  </div>

  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
onkeydown="return search_changed(event, true, '/')"
onkeyup="return search_changed(event, false, '/')" />
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>
  <div id="search_filtered_wrapper">
    <div id="search_filtered_div" class="no-display">
        <ul id="search_filtered">
        </ul>
    </div>
  </div>

  </div>
  <!-- /New Search> -->
        </div>
    </div>
    <!-- /Header -->

  <div id="searchResults" class="wrap" style="display:none;">
          <h2 id="searchTitle">Results</h2>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div>

  
  
  
    
  <div class="wrap clearfix" id="body-content">
    <div class="col-4" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<a class="totop" href="index.html#top" data-g-event="left-nav-top">to top</a>

<!--
    Copyright 2015 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<ul id="nav">
  <li class="nav-section">
    <div class="nav-section-header">
        <a href="../index.html">
          <span class="en">Overview</span>
        </a>
    </div>
    <ul>
      <li><a href="../overview/kernel-security.html">Kernel Security</a></li>
      <li><a href="../overview/app-security.html">App Security</a></li>
      <li><a href="../overview/implement.html">Implementing Security</a></li>
      <li><a href="../overview/updates-resources.html">Updates and Resources</a></li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../enhancements/index.html">
            <span class="en">Enhancements</span>
          </a>
        </div>
        <ul>
          <li><a href="../enhancements/enhancements70.html">Android 7.0</a></li>
          <li><a href="../enhancements/enhancements60.html">Android 6.0</a></li>
          <li><a href="../enhancements/enhancements50.html">Android 5.0</a></li>
          <li><a href="../enhancements/enhancements44.html">Android 4.4</a></li>
          <li><a href="../enhancements/enhancements43.html">Android 4.3</a></li>
          <li><a href="../enhancements/enhancements42.html">Android 4.2</a></li>
          <li><a href="../enhancements/enhancements41.html">Android 4.1</a></li>
        </ul>
      </li>
      <li><a href="../overview/acknowledgements.html">Acknowledgements</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../bulletin/index.html">
        <span class="en">Bulletins</span>
      </a>
    </div>
    <ul>
      <li class="nav-section">
         <div class="nav-section-header">
           <a href="../advisory/index.html">
         <span class="en">Advisories</span>
        </a>
       </div>
         <ul>
           <li><a href="../advisory/2016-03-18.html">2016-03-18</a></li>
         </ul>
      </li>
      <li><a href="../bulletin/2016-08-01.html">August 2016</a></li>
      <li><a href="../bulletin/2016-07-01.html">July 2016</a></li>
      <li><a href="../bulletin/2016-06-01.html">June 2016</a></li>
      <li><a href="../bulletin/2016-05-01.html">May 2016</a></li>
      <li><a href="../bulletin/2016-04-02.html">April 2016</a></li>
      <li><a href="../bulletin/2016-03-01.html">March 2016</a></li>
      <li><a href="../bulletin/2016-02-01.html">February 2016</a></li>
      <li><a href="../bulletin/2016-01-01.html">January 2016</a></li>
      <li class="nav-section">
         <div class="nav-section-header">
           <a href="../bulletin/2015.html">
         <span class="en">2015 Bulletins</span>
        </a>
       </div>
         <ul>
           <li><a href="../bulletin/2015-12-01.html">December 2015</a></li>
           <li><a href="../bulletin/2015-11-01.html">November 2015</a></li>
           <li><a href="../bulletin/2015-10-01.html">October 2015</a></li>
           <li><a href="../bulletin/2015-09-01.html">September 2015</a></li>
           <li><a href="../bulletin/2015-08-01.html">August 2015</a></li>
         </ul>
      </li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../apksigning/index.html">
        <span class="en">Application Signing</span>
      </a>
    </div>
    <ul>
      <li><a href="../apksigning/v2.html">APK Signature Scheme v2</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../authentication/index.html">
        <span class="en">Authentication</span>
      </a>
    </div>
    <ul>
      <li><a href="../../devices/tech/security/authentication/fingerprint-hal.html">Fingerprint HAL</a></li>
      <li><a href="../../devices/tech/security/authentication/gatekeeper.html">Gatekeeper</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../keystore/index.html">
        <span class="en">Keystore</span>
      </a>
    </div>
    <ul>
      <li><a href="../keystore/features.html">Features</a></li>
      <li><a href="../keystore/implementer-ref.html">Implementer's Reference</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="index.html">
        <span class="en">Trusty TEE</span>
      </a>
    </div>
    <ul>
      <li><a href="trusty-ref.html">Trusty API Reference</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../../devices/tech/encryption/index.html">
        <span class="en">Encryption</span>
      </a>
    </div>
    <ul>
      <li><a href="../encryption/file-based.html">File-Based Encryption</a></li>
      <li><a href="../encryption/full-disk.html">Full-Disk Encryption</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../../devices/tech/security/selinux/index.html">
        <span class="en">SELinux</span>
      </a>
    </div>
    <ul>
      <li><a href="../selinux/concepts.html">Concepts</a></li>
      <li><a href="../selinux/implement.html">Implementation</a></li>
      <li><a href="../selinux/customize.html">Customization</a></li>
      <li><a href="../selinux/validate.html">Validation</a></li>
      <li><a href="../selinux/device-policy.html">Writing Policy</a></li>
    </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header">
      <a href="../verifiedboot/index.html">
        <span class="en">Verified Boot</span>
      </a>
    </div>
    <ul>
      <li><a href="../verifiedboot/verified-boot.html">Verifying Boot</a></li>
      <li><a href="../verifiedboot/dm-verity.html">Implementing dm-verity</a></li>
    </ul>
  </li>
</ul>


      </div>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>

  




<div class="col-12" id="doc-col" >


  
    
      
        <h1 itemprop="name" >Trusty TEE</h1>
      
    
  


  
  <div id="jd-content">

    <div class="jd-descr" itemprop="articleBody">
    <!--
    Copyright 2016 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<div id="qv-wrapper">
  <div id="qv">
    <h2>In this document</h2>
    <ol id="auto-toc">
    </ol>
  </div>
</div>

<p>Trusty is a set of software components supporting a Trusted Execution
Environment (TEE) on mobile devices.</p>

<p>Trusty consists of:</p>

<ul>
  <li>An operating system (the Trusty OS) that runs on a processor intended to
provide a TEE
  <li>Drivers for the Android kernel (Linux) to facilitate communication with
applications running under the Trusty OS
  <li>A set of libraries for Android systems software to facilitate communication
with trusted applications executed within the Trusty OS using the kernel
drivers
</ul>

<p><strong>Important</strong>: Trusty and the Trusty API are subject
to change.</p>

<p>For information about the Trusty API, see the <a
href="trusty-ref.html">API Reference</a>.</p>

<h2 id=uses_examples>Uses and examples</h2>

<p>Any TEE OS (not just Trusty) can be used for TEE implementations.</p>

<p>A TEE processor is typically a separate microprocessor in the system or a
virtualized instance of the main processor. The TEE processor is isolated from
the rest of the system using memory and I/O protection mechanisms supported by
the hardware.</p>

<p>TEE processors have become a mainstay in today's mobile devices. The main
processor on these devices is considered "untrusted" and cannot access certain
areas of RAM, hardware registers and fuses where secret data (such as
device-specific cryptographic keys) is stored by the manufacturer. Software
running on the main processor delegates any operations that require use of
secret data to the TEE processor.</p>

<p>The most widely known example of this in the Android ecosystem
is the <a href="../../devices/drm.html">DRM framework</a> for
protected content. Software running on the TEE processor can access
device-specific keys required to decrypt protected content. The main processor
sees only the encrypted content, providing a high level of security and
protection against software-based attacks.</p>

<p>There are many other uses for a TEE such as mobile payments, secure banking,
full-disk encryption, multi-factor authentication, device reset protection,
replay-protected persistent storage, wireless display ("cast") of protected
content, secure PIN and fingerprint processing, and even malware detection.</p>

<p>Trusty provides APIs for developing two classes of applications:</p>

<ul>
  <li>Trusted applications or services that run on the TEE processor
  <li>Normal/untrusted applications that run on the main processor and use services
provided by Trusted applications
</ul>

<p>Software running on the main processor can use Trusty APIs to connect to
trusted applications and exchange arbitrary messages with them, just like a
network service over IP. It is up to the application to determine the data
format and semantics of these messages using an app-level protocol. Reliable
delivery of messages is guaranteed by the underlying Trusty infrastructure (in
the form of drivers running on the main processor), and the communication is
completely asynchronous.</p>

<h2 id=trusted_applications_and_services>Trusted applications and services</h2>

<p>Trusted applications run as isolated processes under the Trusty OS kernel. Each
process runs in its own virtual memory sandbox utilizing the MMU capabilities
of the TEE processor. The kernel schedules these processes using a
priority-based, round-robin scheduler driven by a secure timer tick. In the
current version of Trusty, all Trusty applications share the same priority.</p>

<p>Applications for the Trusty OS can be written in C/C++ (C++ support is
limited), and they have access to a small C library. The <code>main()</code>
function currently does not take any arguments. System call stubs are provided
in native assembly code as part of this library, so system calls can be
accessed by name.</p>

<h3 id=language_threading>Language and threading support</h3>

<p>All Trusty applications are single-threaded; multithreading in Trusty userspace
currently is unsupported.</p>

<h3 id=application_structure>Application structure</h3>

<p>Trusty applications initialize once during load and reside in memory until the
TEE processor is reset. Trusty currently does not support dynamic loading and
unloading of applications.</p>

<p>Trusted applications are written as <strong>event-driven servers</strong>
waiting for commands from other applications or from applications running on
the main processor. Trusted applications can also be clients of other trusted
server applications. Events described in the following API sections will be
delivered to trusted applications by the Trusty kernel.</p>

<h2 id=third-party_trusty_applications>Third-party Trusty applications</h2>

<p>Currently all Trusty applications are developed by a single party and packaged
with the Trusty kernel image. The entire image is signed and verified by the
bootloader during boot. Third-party application development is not supported in
this version of Trusty.</p>

<p>Although the Trusty OS enables the development of new applications, doing so
must be exercised with extreme care; each new application increases the area of
the trusted computing base (TCB) of the system. Trusted applications can access
device secrets and can perform computations or data transformations using them.</p>

<p>The ability to develop new applications that run in the TEE opens up many
possibilities for innovation. However, due to the very definition of TEE, these
applications cannot be distributed without some form of <strong>trust</strong> attached.
Typically this comes in the form of a digital signature by an entity
trusted by the user of the product on which the application runs.</p>

<h2 id=downloading_building>Downloading and building Trusty</h2>

<p>You can find the Trusty implementation in the Android Open Source Project (AOSP) here:<br/>
<a href="https://android-review.googlesource.com/#/admin/projects/?filter=trusty">https://android-review.googlesource.com/#/admin/projects/?filter=trusty</a></p>

<p>The Trusty kernel branches on AOSP are here:<br/>
<a href="https://android.googlesource.com/kernel/common/+/android-trusty-3.10">https://android.googlesource.com/kernel/common/+/android-trusty-3.10</a><br/>
<a href="https://android.googlesource.com/kernel/common/+/android-trusty-3.18">https://android.googlesource.com/kernel/common/+/android-trusty-3.18</a></p>

<p>To make Trusty, run the following commands (assuming the Android toolchain is already in the path):</p>
<pre>
$ repo init -u https://android.googlesource.com/trusty/manifest
$ repo sync
$ make -j24 generic-arm64
</pre>

<p>You may select another supported build target from: <code>device/*/*/project/*</code></p>

    </div>

      <div class="content-footer-sac"
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-9" style="padding-top:4px">
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>
      
      
    </div> <!-- end jd-content -->
  <div id="footer" class="wrap" >
  <style>.feedback { float: right !Important }</style>
  <div class="feedback">
    <a href="index.html#" class="button" onclick=" try {
      userfeedback.api.startFeedback({'productId':'715571','authuser':'1'});return false;}catch(e){}">Site Feedback</a>
  </div>
  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../../license.html">Content 
  License</a>.
  </div>
    <div id="footerlinks">
    
  <p>
    <a href="../../source/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../source/community.html">Community</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
  </p>
  </div>

</div><!-- end doc-content -->

</div> <!-- end body-content --> 






</body>
</html>



