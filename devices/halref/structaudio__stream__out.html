<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Android Hardware Abstraction Layer: audio_stream_out Struct Reference</title>
<link href="http://source.android.com/devices/halref/tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="http://www.gstatic.com/external_hosted/source_android_com/sac_doxygen_jquery.js"></script>
<script type="text/javascript" src="http://source.android.com/devices/halref/dynsections.js"></script>
<link href="http://source.android.com/devices/halref/navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="http://source.android.com/devices/halref/resize.js"></script>
<script type="text/javascript" src="http://source.android.com/devices/halref/navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="http://source.android.com/devices/halref/doxygen.css" rel="stylesheet" type="text/css" />
<link href="http://source.android.com/devices/halref/hal_doxygen.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45455297-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="header">
            <table width=80%>
              <tr>
                <td><a href="http://source.android.com/index.html"><img src="http://source.android.com/assets/images/sac_logo.png" width="123" height="25" alt="Android Developers" /></td>
                <td><a class=toptab href="http://source.android.com/source/index.html">Source</a></td>
                <td><a class=devices href="http://source.android.com/devices/index.html">Devices</a></td>
                <td><a class=toptab href="http://source.android.com/security/index.html">Security</a></td>
                <td><a class=toptab href="http://source.android.com/compatibility/index.html">Compatibility</a></td>
                <td width=20%></td>
              </tr>
            </table>
  </div>
<hr class=light>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structaudio__stream__out.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="structaudio__stream__out.html#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">audio_stream_out Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a9975d0888d3a4eecf4f0144ea954a80f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaudio__stream.html">audio_stream</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#a9975d0888d3a4eecf4f0144ea954a80f">common</a></td></tr>
<tr class="separator:a9975d0888d3a4eecf4f0144ea954a80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11f28f34dd16672bc42edc8a3b68b27"><td class="memItemLeft" align="right" valign="top">uint32_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#ab11f28f34dd16672bc42edc8a3b68b27">get_latency</a> )(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td></tr>
<tr class="separator:ab11f28f34dd16672bc42edc8a3b68b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d042d0e04b8daee587001e808cb49ec"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#a1d042d0e04b8daee587001e808cb49ec">set_volume</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, float left, float right)</td></tr>
<tr class="separator:a1d042d0e04b8daee587001e808cb49ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f0b22a9ac7188e5e1bc8bd927634e2"><td class="memItemLeft" align="right" valign="top">ssize_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#aa7f0b22a9ac7188e5e1bc8bd927634e2">write</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, const void *buffer, size_t bytes)</td></tr>
<tr class="separator:aa7f0b22a9ac7188e5e1bc8bd927634e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a179e9271f35ea937ee175622cfbdc365"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#a179e9271f35ea937ee175622cfbdc365">get_render_position</a> )(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, uint32_t *dsp_frames)</td></tr>
<tr class="separator:a179e9271f35ea937ee175622cfbdc365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1b360476f0d97009f5163c2a050d6a"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#abb1b360476f0d97009f5163c2a050d6a">get_next_write_timestamp</a> )(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, int64_t *timestamp)</td></tr>
<tr class="separator:abb1b360476f0d97009f5163c2a050d6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eedb376c94cd1865fce1e675b9643d5"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#a4eedb376c94cd1865fce1e675b9643d5">set_callback</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, <a class="el" href="audio_8h.html#a95f08f67d844d6555a1623984460795f">stream_callback_t</a> callback, void *cookie)</td></tr>
<tr class="separator:a4eedb376c94cd1865fce1e675b9643d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a520692ffcc11af5382edc621e07a0155"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#a520692ffcc11af5382edc621e07a0155">pause</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td></tr>
<tr class="separator:a520692ffcc11af5382edc621e07a0155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa0984f41214227dae3c29145c2abc8"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#a5fa0984f41214227dae3c29145c2abc8">resume</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td></tr>
<tr class="separator:a5fa0984f41214227dae3c29145c2abc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9be8a32a2b4243373efa38e119b4b86"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#af9be8a32a2b4243373efa38e119b4b86">drain</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, <a class="el" href="audio_8h.html#ab8454845a050557d8efa4d0114c5d308">audio_drain_type_t</a> type)</td></tr>
<tr class="separator:af9be8a32a2b4243373efa38e119b4b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9669ff68dfb3f7b8b017a1979d7d95"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#aff9669ff68dfb3f7b8b017a1979d7d95">flush</a> )(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td></tr>
<tr class="separator:aff9669ff68dfb3f7b8b017a1979d7d95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae62e118ae9d2faf424da855e13a71277"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaudio__stream__out.html#ae62e118ae9d2faf424da855e13a71277">get_presentation_position</a> )(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, uint64_t *frames, struct timespec *timestamp)</td></tr>
<tr class="separator:ae62e118ae9d2faf424da855e13a71277"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="structaudio__stream__out.html">audio_stream_out</a> is the abstraction interface for the audio output hardware.</p>
<p>It provides information about various properties of the audio output hardware driver. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00276">276</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a class="anchor" id="a9975d0888d3a4eecf4f0144ea954a80f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaudio__stream.html">audio_stream</a> common</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Common methods of the audio stream out. This <em>must</em> be the first member of <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> as users of this structure will cast a <a class="el" href="structaudio__stream.html">audio_stream</a> to <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> pointer in contexts where it's known the <a class="el" href="structaudio__stream.html">audio_stream</a> references an <a class="el" href="structaudio__stream__out.html">audio_stream_out</a>. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00282">282</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="af9be8a32a2b4243373efa38e119b4b86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* drain)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, <a class="el" href="audio_8h.html#ab8454845a050557d8efa4d0114c5d308">audio_drain_type_t</a> type)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Requests notification when data buffered by the driver/hardware has been played. If <a class="el" href="structaudio__stream__out.html#a4eedb376c94cd1865fce1e675b9643d5">set_callback()</a> has previously been called to enable non-blocking mode, the <a class="el" href="structaudio__stream__out.html#af9be8a32a2b4243373efa38e119b4b86">drain()</a> must not block, instead it should return quickly and completion of the drain is notified through the callback. If <a class="el" href="structaudio__stream__out.html#a4eedb376c94cd1865fce1e675b9643d5">set_callback()</a> has not been called, the <a class="el" href="structaudio__stream__out.html#af9be8a32a2b4243373efa38e119b4b86">drain()</a> must block until completion. If type==AUDIO_DRAIN_ALL, the drain completes when all previously written data has been played. If type==AUDIO_DRAIN_EARLY_NOTIFY, the drain completes shortly before all data for the current track has played to allow time for the framework to perform a gapless track switch.</p>
<p>Drain must return immediately on stop() and <a class="el" href="structaudio__stream__out.html#aff9669ff68dfb3f7b8b017a1979d7d95">flush()</a> call</p>
<p>Implementation of this function is mandatory for offloaded playback. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00372">372</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="aff9669ff68dfb3f7b8b017a1979d7d95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* flush)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Notifies to the audio driver to flush the queued data. Stream must already be paused before calling <a class="el" href="structaudio__stream__out.html#aff9669ff68dfb3f7b8b017a1979d7d95">flush()</a>.</p>
<p>Implementation of this function is mandatory for offloaded playback. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00380">380</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab11f28f34dd16672bc42edc8a3b68b27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t(* get_latency)(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the audio hardware driver estimated latency in milliseconds. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00287">287</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="abb1b360476f0d97009f5163c2a050d6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* get_next_write_timestamp)(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, int64_t *timestamp)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>get the local time at which the next write to the audio driver will be presented. The units are microseconds, where the epoch is decided by the local audio HAL. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00324">324</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae62e118ae9d2faf424da855e13a71277"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* get_presentation_position)(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, uint64_t *frames, struct timespec *timestamp)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a recent count of the number of audio frames presented to an external observer. This excludes frames which have been written but are still in the pipeline. The count is not reset to zero when output enters standby. Also returns the value of CLOCK_MONOTONIC as of this presentation count. The returned count is expected to be 'recent', but does not need to be the most recent possible value. However, the associated time should correspond to whatever count is returned. Example: assume that N+M frames have been presented, where M is a 'small' number. Then it is permissible to return N instead of N+M, and the timestamp should correspond to N rather than N+M. The terms 'recent' and 'small' are not defined. They reflect the quality of the implementation.</p>
<p>3.0 and higher only. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00398">398</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="a179e9271f35ea937ee175622cfbdc365"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* get_render_position)(const struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, uint32_t *dsp_frames)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00317">317</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="a520692ffcc11af5382edc621e07a0155"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* pause)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Notifies to the audio driver to stop playback however the queued buffers are retained by the hardware. Useful for implementing pause/resume. Empty implementation if not supported however should be implemented for hardware with non-trivial latency. In the pause state audio hardware could still be using power. User may consider calling suspend after a timeout.</p>
<p>Implementation of this function is mandatory for offloaded playback. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00345">345</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5fa0984f41214227dae3c29145c2abc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* resume)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Notifies to the audio driver to resume playback following a pause. Returns error if called without matching pause.</p>
<p>Implementation of this function is mandatory for offloaded playback. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00353">353</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4eedb376c94cd1865fce1e675b9643d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* set_callback)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, <a class="el" href="audio_8h.html#a95f08f67d844d6555a1623984460795f">stream_callback_t</a> callback, void *cookie)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>set the callback function for notifying completion of non-blocking write and drain. Calling this function implies that all future <a class="el" href="structaudio__stream__out.html#aa7f0b22a9ac7188e5e1bc8bd927634e2">write()</a> and <a class="el" href="structaudio__stream__out.html#af9be8a32a2b4243373efa38e119b4b86">drain()</a> must be non-blocking and use the callback to signal completion. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00333">333</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1d042d0e04b8daee587001e808cb49ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* set_volume)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, float left, float right)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Use this method in situations where audio mixing is done in the hardware. This method serves as a direct interface with hardware, allowing you to directly set the volume as apposed to via the framework. This method might produce multiple PCM outputs or hardware accelerated codecs, such as MP3 or AAC. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00296">296</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa7f0b22a9ac7188e5e1bc8bd927634e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t(* write)(struct <a class="el" href="structaudio__stream__out.html">audio_stream_out</a> *stream, const void *buffer, size_t bytes)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write audio buffer to driver. Returns number of bytes written, or a negative status_t. If at least one frame was written successfully prior to the error, it is suggested that the driver return that successful (short) byte count and then return an error in the subsequent call.</p>
<p>If <a class="el" href="structaudio__stream__out.html#a4eedb376c94cd1865fce1e675b9643d5">set_callback()</a> has previously been called to enable non-blocking mode the <a class="el" href="structaudio__stream__out.html#aa7f0b22a9ac7188e5e1bc8bd927634e2">write()</a> is not allowed to block. It must write only the number of bytes that currently fit in the driver/hardware buffer and then return this byte count. If this is less than the requested write size the callback function must be called when more space is available in the driver/hardware buffer. </p>

<p>Definition at line <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html#l00311">311</a> of file <a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>hardware/libhardware/include/hardware/<a class="el" href="http://source.android.com/devices/halref/audio_8h_source.html">audio.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structaudio__stream__out.html">audio_stream_out</a></li>
    <li class="footer">Generated on Mon Jun 20 2016 18:43:21 for Android Hardware Abstraction Layer by
    <a href="http://source.android.com/index.html">
    <img class="footer" src="http://source.android.com/images/Android_Robot_100.png" alt="Android"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
