<!DOCTYPE html>











































































































<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<meta name="Description" content="The system builds the updater binary from bootable&#47;recovery&#47;updater and uses it in an OTA package. Updater contains several builtin functions and an interpreter for an extensible scripting language ( edify ) that supports commands for typical …">

<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico" />
<title>Inside OTA Packages | Android Open Source Project</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="https://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="../../../assets/css/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="https://www.google.com/jsapi" type="text/javascript"></script>
<script src="../../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "/";
  
  var devsite = false;
  
</script>
<script src="../../../assets/js/docs.js" type="text/javascript"></script>

<script src="../../../navtree_data.js" type="text/javascript"></script>


<script type="text/javascript" src="https://www.gstatic.com/feedback/api.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45455297-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body class="gc-documentation 
  " itemscope itemtype="http://schema.org/Article">
<a name="top"></a>

  
    <!-- Header -->
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 saclogo">
          <a href="../../../index.html">
            <img src="../../../assets/images/sac_logo.png"
                srcset="/assets/images/sac_logo@2x.png 2x"
                width="123" height="25" alt="Android Open Source Project" />
          </a>
          </div>
            <ul class="nav-x col-9">
                <li class="source">
                  <a href="../../../source/index.html" 
                  >Source</a></li>
                <li class="devices"><a href="../../index.html" class="selected"
                  >Devices</a></li>
                <li class="security"><a href="../../../security/index.html" 
                  >Security</a></li>
                <li class="compatibility last"><a href="../../../compatibility/index.html" 
                  >Compatibility</a></li>
            </ul>
            <!-- New Search -->
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Android Sites</div>
      <ul>
        <li class="active"><a>Android Open Source Project</a></li>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li><a href="http://developer.android.com">Android Developers</a></li>
      </ul>
      <!-- <div class="header">Support</div>
      <ul>
        <li><a href="/support.html">Developer Support</a></li>
      </ul> -->
      <br class="clearfix" />
    </div>
    <div class="bottom"></div>
  </div>

  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
onkeydown="return search_changed(event, true, '/')"
onkeyup="return search_changed(event, false, '/')" />
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>
  <div id="search_filtered_wrapper">
    <div id="search_filtered_div" class="no-display">
        <ul id="search_filtered">
        </ul>
    </div>
  </div>

  </div>
  <!-- /New Search> -->
        </div>
    </div>
    <!-- /Header -->

  <div id="searchResults" class="wrap" style="display:none;">
          <h2 id="searchTitle">Results</h2>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div>

  
  
  
    
  <div class="wrap clearfix" id="body-content">
    <div class="col-4" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<a class="totop" href="inside_packages.html#top" data-g-event="left-nav-top">to top</a>

<!--
    Copyright 2015 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<ul id="nav">
  <li class="nav-section">  <!-- Begin nav section, Device Interfaces -->
    <div class="nav-section-header">
      <a href="../../index.html">
        <span class="en">Interfaces</span>
      </a>
    </div>
    <ul>
  <li class="nav-section">
  <div class="nav-section-header">
      <a href="../../accessories/index.html">
        <span class="en">Accessories</span>
      </a>
    </div>
    <ul>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../accessories/audio.html">
            <span class="en">Audio Accessories</span>
          </a>
        </div>
        <ul>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../accessories/headset/index.html">
            <span class="en">Headset</span>
          </a>
        </div>
        <ul>
          <li><a href="../../accessories/headset/specification.html">Specification</a></li>
          <li><a href="../../accessories/headset/requirements.html">Requirements</a></li>
          <li><a href="../../accessories/headset/testing.html">Testing</a></li>
        </ul>
      </li>
        </ul>
      </li>
  <li class="nav-section">
  <div class="nav-section-header">
      <a href="../../accessories/custom.html">
        <span class="en">Custom Accessories</span>
      </a>
    </div>
    <ul>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../accessories/protocol.html"><span class="en">AOA</span>
        </a>
        </div>
        <ul>
          <li><a href="../../accessories/aoa2.html">AOA 2.0</a></li>
          <li><a href="../../accessories/aoa.html">AOA 1.0</a></li>
        </ul>
        </li>
        <div class="nav-section-header"><a href="../../accessories/stylus.html"><span class="en">Stylus</span>
        </a>
        </div>
       </ul>
     </li>
    </ul>
      <li class="nav-section">
      <div class="nav-section-header">
        <a href="../../audio/index.html">
          <span class="en">Audio</span>
        </a>
      </div>
        <ul>
          <li><a href="../../audio/terminology.html">Terminology</a></li>
          <li class="nav-section">
            <div class="nav-section-header">
              <a href="../../audio/implement.html">
                <span class="en">Implementation</span>
              </a>
            </div>
            <ul>
              <li><a href="../../audio/implement-policy.html">Policy Configuration</a></li>
              <li><a href="../../audio/implement-shared-library.html">Shared Library</a></li>
              <li><a href="../../audio/implement-pre-processing.html">Pre-processing Effects</a></li>
            </ul>
         </li>
          <li><a href="../../audio/data_formats.html">Data Formats</a></li>
          <li><a href="../../audio/attributes.html">Attributes</a></li>
          <li><a href="../../audio/warmup.html">Warmup</a></li>
          <li class="nav-section">
            <div class="nav-section-header">
              <a href="../../audio/latency.html">
                <span class="en">Latency</span>
              </a>
            </div>
            <ul>
              <li><a href="../../audio/latency_contrib.html">Contributors</a></li>
              <li><a href="../../audio/latency_design.html">Design</a></li>
              <li><a href="../../audio/latency_measure.html">Measure</a></li>
              <li><a href="../../audio/testing_circuit.html">Light Testing Circuit</a></li>
              <li><a href="../../audio/loopback.html">Audio Loopback Dongle</a></li>
              <li><a href="../../audio/latency_measurements.html">Measurements</a></li>
              <li><a href="../../audio/latency_app.html">Applications</a></li>
            </ul>
          </li>
          <li><a href="../../audio/avoiding_pi.html">Priority Inversion</a></li>
          <li><a href="../../audio/src.html">Sample Rate Conversion</a></li>
          <li><a href="../../audio/debugging.html">Debugging</a></li>
          <li class="nav-section">
            <div class="nav-section-header">
              <a href="../../audio/midi.html">
                <span class="em">MIDI</span>
              </a>
            </div>
            <ul>
              <li><a href="../../audio/midi_arch.html">MIDI Architecture</a></li>
              <li><a href="../../audio/midi_test.html">MIDI Test Procedure</a></li>
            </ul>
          <li><a href="../../audio/usb.html">USB Digital Audio</a></li>
          <li><a href="../../audio/tv.html">TV Audio</a></li>
        </ul>
      </li>
      <li><a href="../../automotive.html">Automotive</a></li>
      <li><a href="../../bluetooth.html">Bluetooth</a></li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../camera/index.html">
            <span class="en">Camera</span>
          </a>
        </div>
        <ul>
          <li><a href="../../camera/camera3.html">Camera HAL3</a></li>
          <li><a href="../../camera/camera3_requests_hal.html">HAL Subsystem</a></li>
          <li><a href="../../camera/camera3_metadata.html">Metadata and Controls</a></li>
          <li><a href="../../camera/camera3_3Amodes.html">3A Modes and State</a></li>
          <li><a href="../../camera/camera3_crop_reprocess.html">Output and Cropping</a></li>
          <li><a href="../../camera/camera3_error_stream.html">Errors and Streams</a></li>
          <li><a href="../../camera/camera3_requests_methods.html">Request Creation</a></li>
          <li><a href="../../camera/versioning.html">Version Support</a></li>
        </ul>
      </li>

      <li><a href="../../drm.html">DRM</a></li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../graphics/index.html">
            <span class="en">Graphics</span>
          </a>
        </div>
        <ul>
         <li class="nav-section">
            <div class="nav-section-header">
              <a href="../../graphics/architecture.html">
                <span class="en">Architecture</span>
              </a>
            </div>
            <ul>
              <li><a href="../../graphics/arch-bq-gralloc.html">BufferQueue</a></li>
              <li><a href="../../graphics/arch-sf-hwc.html">SurfaceFlinger and HWC</a></li>
              <li><a href="../../graphics/arch-sh.html">Surface and SurfaceHolder</a></li>
              <li><a href="../../graphics/arch-egl-opengl.html">OpenGL ES</a></li>
              <li><a href="../../graphics/arch-vulkan.html">Vulkan</a></li>
              <li><a href="../../graphics/arch-sv-glsv.html">SurfaceView</a></li>
              <li><a href="../../graphics/arch-st.html">SurfaceTexture</a></li>
              <li><a href="../../graphics/arch-tv.html">TextureView</a></li>
              <li><a href="../../graphics/arch-gameloops.html">Game Loops</a></li>
            </ul>
         </li>
         <li class="nav-section">
            <div class="nav-section-header">
              <a href="../../graphics/implement.html">
                <span class="en">Implementing</span>
              </a>
            </div>
            <ul>
              <li><a href="../../graphics/implement-hwc.html">Hardware Composer HAL</a></li>
              <li><a href="../../graphics/implement-vsync.html">VSYNC</a></li>
              <li><a href="../../graphics/implement-vulkan.html">Vulkan</a></li>
              <li><a href="../../graphics/implement-vdisplays.html">Virtual Displays</a></li>
            </ul>
         </li>
         <li class="nav-section">
            <div class="nav-section-header">
              <a href="../../graphics/testing.html">
                <span class="en">OpenGL ES Testing</span>
              </a>
            </div>
            <ul>
              <li><a href="../../graphics/build-tests.html">Building test programs</a></li>
              <li><a href="../../graphics/port-tests.html">Porting the test framework</a></li>
              <li><a href="../../graphics/run-tests.html">Running the tests</a></li>
              <li><a href="../../graphics/automate-tests.html">Automating the tests</a></li>
              <li><a href="../../graphics/test-groups.html">Using special test groups</a></li>
              <li><a href="../../graphics/cts-integration.html">Integrating with Android CTS</a></li>
            </ul>
         </li>
        </ul> </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../input/index.html">
            <span class="en">Input</span>
          </a>
        </div>
        <ul>
          <li><a href="../../input/overview.html">Overview</a></li>
          <li><a href="../../input/key-layout-files.html">Key Layout Files</a></li>
          <li><a href="../../input/key-character-map-files.html">Key Character Map Files</a></li>
          <li><a href="../../input/input-device-configuration-files.html">Input Device Configuration Files</a></li>
          <li><a href="../../input/migration-guide.html">Migration Guide</a></li>
          <li><a href="../../input/keyboard-devices.html">Keyboard Devices</a></li>
          <li><a href="../input/touch-devices.html">Touch Devices</a></li>
          <li><a href="../input/dumpsys.html">Diagnostics</a></li>
          <li><a href="../../input/getevent.html">Getevent</a></li>
          <li><a href="../../input/validate-keymaps.html">Validate Keymaps</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../media.html">
            <span class="en">Media</span>
          </a>
        </div>
        <ul>
          <li><a href="../../media/framework-hardening.html">Framework
          Hardening</a></li>
          <li><a href="../../media/soc.html">SoC Dependencies</a></li>
          <li><a href="../../media/oem.html">OEM Dependencies</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../sensors/index.html">
            <span class="en">Sensors</span>
          </a>
        </div>
        <ul>
          <li><a href="../../sensors/sensor-stack.html">Sensor stack</a></li>
          <li><a href="../../sensors/report-modes.html">Reporting modes</a></li>
          <li><a href="../../sensors/suspend-mode.html">Suspend mode</a></li>
          <li><a href="../../sensors/power-use.html">Power consumption</a></li>
          <li><a href="../../sensors/interaction.html">Interaction</span></a></li>
          <li><a href="../../sensors/hal-interface.html">HAL interface</a></li>
          <li><a href="../../sensors/batching.html">Batching</a></li>
          <li><a href="../../sensors/sensor-types.html">Sensor types</a></li>
          <li><a href="../../sensors/versioning.html">Version deprecation</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="https://source.android.com/devices/storage/index.html">
            <span class="en">Storage</span>
          </a>
        </div>
        <ul>
          <li><a href="../../storage/traditional.html">Traditional Storage</a></li>
          <li><a href="../../storage/adoptable.html">Adoptable Storage</a></li>
          <li><a href="../../storage/config.html">Device Configuration</a></li>
          <li><a href="../../storage/config-example.html">Configuration Examples</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../tv/index.html">
            <span class="en">TV</span>
          </a>
        </div>
        <ul>
          <li><a href="../../tv/HDMI-CEC.html">HDMI-CEC control service</a></li>
          <li><a href="../../tv/reference-tv-app.html">Reference TV App</a></li>
        </ul>
      </li>
    </ul>
  </li> <!-- End nav-section, Device Interfaces-->


  <li class="nav-section"> <!--Begin nav-section, Core Technologies-->
    <div class="nav-section-header">
      <a href="../index.html">
        <span class="en">Core Technologies</span>
      </a>
    </div>

    <ul>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../dalvik/index.html">
          <span class="en">ART and Dalvik</span></a>
        </div>
        <ul>
          <li><a href="../dalvik/dalvik-bytecode.html">Bytecode Format</a></li>
          <li><a href="../dalvik/dex-format.html">.Dex Format</a></li>
          <li><a href="../dalvik/instruction-formats.html">Instruction Formats</a></li>
          <li><a href="../dalvik/constraints.html">Constraints</a></li>
          <li><a href="../dalvik/configure.html">Configuration</a></li>
          <li><a href="../dalvik/gc-debug.html">Garbage Collection</a></li>
          <li><a href="../dalvik/jit-compiler.html">JIT Compilation</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="../config/index.html">
              <span class="en">Configuration</span>
            </a>
        </div>
        <ul>
          <li><a href="../config/carrier.html">Carrier Customization</a></li>
          <li><a href="../config/connect_tests.html">Connectivity Tests</a></li>
          <li><a href="../config/filesystem.html">File System</a></li>
          <li><a href="../kernel.html">Kernel Configuration</a></li>
          <li><a href="../config/kernel_network_tests.html">Kernel Network Tests</a></li>
          <li><a href="../config/low-ram.html">Low RAM</a></li>
          <li><a href="../config/namespaces_libraries.html">Namespaces for Libraries</a></li>
          <li><a href="../config/renderer.html">OpenGLRenderer</a></li>
          <li><a href="../config/runtime_perms.html">Runtime Permissions</a></li>
          <li><a href="../config/uicc.html">UICC</a></li>
          <li><a href="../config/voicemail.html">Visual Voicemail</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="../connect/index.html">
              <span class="en">Connectivity</span>
            </a>
        </div>
        <ul>
          <li><a href="../connect/block-numbers.html">Block Phone Numbers</a></li>
          <li><a href="../connect/call-notification.html">Call Notifications</a></li>
          <li><a href="../connect/data-saver.html">Data Saver Mode</a></li>
          <li><a href="../connect/emergency-affordance.html">Emergency Affordance</a></li>
          <li><a href="../connect/felica.html">Host Card Emulation of FeliCa</a></li>
          <li><a href="../connect/ril.html">Radio Interface Layer (RIL)</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../datausage/index.html">
            <span class="en">Data Usage</span>
          </a>
        </div>
        <ul>
          <li><a href="../datausage/iface-overview.html">Network interface statistics overview</a></li>
          <li><a href="../datausage/excluding-network-types.html">Excluding Network Types from Data Usage</a></li>
          <li><a href="../datausage/tethering-data.html">Tethering Data</a></li>
          <li><a href="../datausage/usage-cycle-resets-dates.html">Usage Cycle Reset Dates</a></li>
          <li><a href="../datausage/kernel-overview.html">Kernel Overview</a></li>
          <li><a href="../datausage/tags-explained.html">Data Usage Tags Explained</a></li>
          <li><a href="../datausage/kernel-changes.html">Kernel Changes</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../debug/index.html">
            <span class="en">Debugging</span>
          </a>
        </div>
        <ul>
          <li><a href="../debug/asan.html">AddressSanitizer</a></li>
          <li><a href="../debug/dumpsys.html">Dumpsys</a></li>
          <li><a href="../debug/native-memory.html">Native Memory Use</a></li>
          <li><a href="../debug/netstats.html">Network Use</a></li>
          <li><a href="../debug/procstats.html">RAM Use</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../admin/index.html">
          <span class="en">Device Administration</span></a>
        </div>
        <ul>
          <li><a href="../admin/implement.html">Implementation</a></li>
          <li><a href="../admin/multi-user.html">Multiple Users</a></li>
          <li><a href="../admin/managed-profiles.html">Managed Profiles</a></li>
          <li><a href="../admin/provision.html">Provisioning</a></li>
          <li><a href="../admin/multiuser-apps.html">Multiuser Apps</a></li>
          <li><a href="../admin/enterprise-telephony.html">Enterprise Telephony</a></li>
          <li><a href="../admin/testing-provision.html">Testing Device Provisioning</a></li>
          <li><a href="../admin/testing-setup.html">Testing Device Administration</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="../display/index.html">
              <span class="en">Display Settings</span></a>
        </div>
        <ul>
          <li><a href="../display/dnd.html">Do Not Disturb</a></li>
          <li><a href="../display/multi-window.html">Multi-Window</a></li>
          <li><a href="../display/hdr.html">HDR Video</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header empty">
          <a href="../../halref/index.html">
            <span class="en">HAL File Reference</span>
          </a>
        </div>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="index.html">
              <span class="en">OTA Updates</span>
            </a>
        </div>
        <ul>
          <li><a href="tools.html">OTA Tools</a></li>
          <li><a href="block.html">Block-based OTA</a></li>
          <li><a href="inside_packages.html">Inside OTA Packages</a></li>
          <li><a href="device_code.html">Device-Specific Code</a></li>
          <li><a href="reduce_size.html">Reducing OTA Size</a></li>
          <li><a href="sign_builds.html">Signing Builds for Release</a></li>
          <li><a href="ab_updates.html">A/B System Updates</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../power/index.html"><span class="en">Power</span></a>
        </div>
        <ul>
          <li><a href="../power/mgmt.html">Power Management</a></li>
          <li><a href="../power/performance.html">Performance Management</a></li>
          <li><a href="../power/component.html">Component Power</a></li>
          <li><a href="../power/device.html">Device Power</a></li>
          <li><a href="../power/values.html">Power Values</a></li>
          <li><a href="../power/batterystats.html">Battery Use</a>
          </li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../test_infra/tradefed/index.html">
            <span class="en">Testing Infrastructure</span>
          </a>
        </div>
        <ul>
          <li><a href="../test_infra/tradefed/fundamentals/index.html">Start Here</a></li>
          <li><a href="../test_infra/tradefed/fundamentals/machine_setup.html">Machine Setup</a></li>
          <li><a href="../test_infra/tradefed/fundamentals/devices.html">Working with Devices</a></li>
          <li><a href="../test_infra/tradefed/fundamentals/lifecycle.html">Test Lifecycle</a></li>
          <li><a href="../test_infra/tradefed/fundamentals/options.html">Option Handling</a></li>
          <li><a href="../test_infra/tradefed/full_example.html">An End-to-End Example</a></li>
          <li id="tradefed-tree-list" class="nav-section">
            <div class="nav-section-header">
              <a href="../../../reference/packages.html">
                <span class="en">Package Index</span>
              </a>
            </div>
          </li>
        </ul>
      </li>
    </ul>
  </li> <!-- End nav-section, Core Technologies -->
</ul> 


      </div>
      <script type="text/javascript">
        showTradefedRefTree();
      </script>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>

  




<div class="col-12" id="doc-col" >


  
    
      
        <h1 itemprop="name" >Inside OTA Packages</h1>
      
    
  


  
  <div id="jd-content">

    <div class="jd-descr" itemprop="articleBody">
    <!--
    Copyright 2015 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<div id="qv-wrapper">
  <div id="qv">
    <h2>In this document</h2>
    <ol id="auto-toc">
    </ol>
  </div>
</div>

<p>The system builds the updater binary from <code>bootable/recovery/updater
</code> and uses it in an OTA package.</p>The package itself is a .zip file
(<code>ota_update.zip</code>, <code>incremental_ota_update.zip</code>) that
contains the executable binary <code>META-INF/com/google/android/update-binary
</code>.

<p>Updater contains several builtin functions and an interpreter for an
extensible scripting language (<b>edify</b>) that supports commands for typical
update-related tasks. Updater looks in the package .zip file for a script in the
file <code>META-INF/com/google/android/updater-script</code>.</p>

<p class="note"><strong>Note:</strong> Using the edify script and/or builtin
functions is not a common activity, but can be helpful if you need to debug the
update file.</p>

<h2 id="edify-syntax">Edify syntax</h2>
<p>An edify script is a single expression in which all values are strings.
Empty strings are <i>false</i> in a Boolean context and all other strings are
<i>true</i>. Edify supports the following operators (with the usual meanings):
</p>

<pre>
(<i>expr</i> )
 <i>expr</i> <b>+</b> <i>expr</i>  # string concatenation, not integer addition
 <i>expr</i> <b>==</b> <i>expr</i>
 <i>expr</i> <b>!=</b> <i>expr</i>
 <i>expr</i> <b>&amp;&amp;</b> <i>expr</i>
 <i>expr</i> <b>||</b> <i>expr</i>
 ! <i>expr</i>
 if <i>expr</i> <b>then</b> <i>expr</i> <b>endif</b>
 if <i>expr</i> <b>then</b> <i>expr</i> <b>else</b> <i>expr</i> <b>endif</b>
 <i>function_name</i><b>(</b><i>expr</i><b>,</b> <i>expr</i><b>,</b><i>...</i><b>)</b>
 <i>expr</i><b>;</b> <i>expr</i>
</pre>

<p>Any string of the characters <i>a-z, A-Z, 0-9, _, :, /, .</i> that isn't a
reserved word is considered a string literal. (Reserved words are <b>if else
</b> then <b>endif.</b>) String literals may also appear in double-quotes;
this is how to create values with whitespace and other characters not in the
above set. \n, \t, \", and \\ serve as escapes within quoted strings, as does
\x<i>##</i>.</p>
<p>The &amp;&amp; and || operators are short-circuiting; the right side is not
evaluated if the logical result is determined by the left side. The
following are equivalent:</p>
<pre>
<i>e1</i> <b>&amp;&amp;</b> <i>e2</i>
<b>if</b> <i>e1</i> <b>then</b> <i>e2</i> <b>endif</b></pre>
<p>The ; operator is a sequence point; it means to evaluate first the left
side and then the right side. Its value is the value of the right-side
expression. A semicolon can also appear after an expression, so the effect
simulates C-style statements:</p>

<pre>
<b>prepare();
do_other_thing("argument");
finish_up();</b>
</pre>

<h2 id="builtin-functions">Built-in functions</h2>
<p>Most update functionality is contained in the functions available for
execution by scripts. (Strictly speaking these are <i>macros</i> rather than
<i>functions</i> in the Lisp sense, since they need not evaluate all of their
arguments.) Unless otherwise noted, functions return <b>true</b> on success
and <b>false</b> on error. If you want errors to abort execution of the
script, use the <code>abort()</code> and/or <code>assert()</code> functions.
The set of functions available in updater can also be extended to provide
<a href="device_code.html">device-specific
functionality</a>.

<dl>
<dt><code>abort([<i>msg</i>])</code></dt>
<dd>Aborts execution of the script immediately, with the optional <i>msg</i>.
If the user has turned on text display, <i>msg</i> appears in the recovery log
and on-screen.</dd>
<dt><code>assert(<i>expr</i>[, <i>expr</i>, ...])</code></dt>
<dd>Evaluates each <i>expr</i> in turn. If any is false, immediately aborts
execution with the message "assert failed" and the source text of the failed
expression.</dd>
<dt><code>apply_patch(<i>src_file</i>, <i>tgt_file</i>, <i>tgt_sha1</i>, <i>
tgt_size</i>, <i>patch1_sha1</i>, <i>patch1_blob</i>, [...])</code></dt>
<dd>Applies a binary patch to the <i>src_file</i> to produce the <i>tgt_file
</i>. If the desired target is the same as the source, pass "-" for <i>tgt_file
</i>. <i>tgt_sha1</i> and <i>tgt_size</i> are the expected final SHA1 hash and
size of the target file. The remaining arguments must come in pairs: a SHA1
hash (a 40-character hex string) and a blob. The blob is the patch to be
applied when the source file's current contents have the given SHA1.
<p>The patching is done in a safe manner that guarantees the target file
either has the desired SHA1 hash and size, or it is untouched—it will not be
left in an unrecoverable intermediate state. If the process is interrupted
during patching, the target file may be in an intermediate state; a copy exists
in the cache partition so restarting the update can successfully update the
file.</p>
<p>Special syntax is supported to treat the contents of Memory Technology
Device (MTD) partitions as files, allowing patching of raw partitions such as
boot. To read an MTD partition, you must know how much data you want to read
since the partition does not have an end-of-file notion. You can use the
string "MTD:<i>partition</i>:<i>size_1</i>:<i>sha1_1</i>:<i>size_2</i>:<i>
sha1_2</i>" as a filename to read the given partition. You must specify at
least one <i>(size, sha-1)</i> pair; you can specify more than one if there
are multiple possibilities for what you expect to read.</p></dd>
<dt><code>apply_patch_check(<i>filename</i>, <i>sha1</i>[, <i>sha1</i>, ...])
</code></dt>
<dd>Returns true if the contents of <i>filename</i> or the temporary copy in
the cache partition (if present) have a SHA1 checksum equal to one of the
given <i>sha1</i> values. <i>sha1</i> values are specified as 40 hex digits.
This function differs from <code>sha1_check(read_file(<i>filename</i>),
<i>sha1</i> [, ...])</code> in that it knows to check the cache partition copy,
so <code>apply_patch_check()</code> will succeed even if the file was corrupted
by an interrupted <code>apply_patch() update</code>.</dd>
<dt><code>apply_patch_space(<i>bytes</i>)</code></dt>
<dd>Returns true if at least <i>bytes</i> of scratch space is available for
applying binary patches.</dd>
<dt><code>concat(<i>expr</i>[, <i>expr</i>, ...])</code></dt>
<dd>Evaluates each expression and concatenates them. The + operator is
syntactic sugar for this function in the special case of two arguments (but
the function form can take any number of expressions). The expressions must be
strings; it can't concatenate blobs.</dd>
<dt><code>delete([<i>filename</i>, ...])</code></dt>
<dd>Deletes all the <i>filename</i>s listed. Returns the number of files
successfully deleted.</dd>
<dt><code>delete_recursive([<i>dirname</i>, ...])</code></dt>
<dd>Recursively deletes <i>dirname</i>s and all their contents. Returns the
number of directories successfully deleted.</dd>
<dt><code>file_getprop(<i>filename</i>, <i>key</i>)</code></dt>
<dd>Reads the given <i>filename</i>, interprets it as a properties file (e.g.
<code>/system/build.prop</code>), and returns the value of the given <i>key</i>
, or the empty string if <i>key</i> is not present.</dd>
<dt><code>format(<i>fs_type</i>, <i>partition_type</i>, <i>location</i>, <i>
fs_size</i>, <i>mount_point</i>)</code></dt>
<dd>Reformats a given partition. Supported partition types:
<ul>
<li>fs_type="yaffs2" and partition_type="MTD". Location must be the name of
the MTD partition; an empty yaffs2 filesystem is constructed there. Remaining
arguments are unused.</li>
<li>fs_type="ext4" and partition_type="EMMC". Location must be the device file
for the partition. An empty ext4 filesystem is constructed there. If
<i>fs_size</i> is zero, the filesystem takes up the entire partition. If
<i>fs_size</i> is a positive number, the filesystem takes the first
<i>fs_size</i> bytes of the partition. If <i>fs_size</i> is a
negative number, the filesystem takes all except the last <i>|fs_size|</i>
bytes of the partition.</li>
<li>fs_type="f2fs" and partition_type="EMMC". Location must be the device file
for the partition. <i>fs_size</i> must be a non-negative number. If
<i>fs_size</i> is zero, the filesystem takes up the entire partition. If
<i>fs_size</i> is a positive number, the filesystem takes the first
<i>fs_size</i> bytes of the partition.</li>
<li>mount_point should be the future mount point for the filesystem.</li></ul>
</dd>
<dt><code>getprop(<i>key</i>)</code></dt>
<dd>Returns the value of system property <i>key</i> (or the empty string, if
it's not defined). The system property values defined by the recovery
partition are not necessarily the same as those of the main system. This
function returns the value in recovery.</dd>
<dt><code>greater_than_int(<i>a</i>, <i>b</i>)</code></dt>
<dd>Returns true if and only if (iff) <i>a</i> (interpreted as an integer) is
greater than <i>b</i> (interpreted as an integer).</dd>
<dt><code>ifelse(<i>cond</i>, <i>e1</i>[, <i>e2</i>])</code></dt>
<dd>Evaluates <i>cond</i>, and if it is true evaluates and returns the value
of <i>e1</i>, otherwise it evaluates and returns <i>e2</i> (if present). The
"if ... else ... then ... endif" construct is just syntactic sugar for this
function.</dd>
<dt><code>is_mounted(<i>mount_point</i>)</code></dt>
<dd>Returns true iff there is a filesystem mounted at <i>mount_point</i>.</dd>
<dt><code>is_substring(<i>needle</i>, <i>haystack</i>)</b></code></dt>
<dd>Returns true iff <i>needle</i> is a substring of <i>haystack</i>.</dd>
<dt><code>less_than_int(<i>a</i>, <i>b</i>)</code></dt>
<dd>Returns true iff <i>a</i> (interpreted as an integer) is less than <i>b</i>
(interpreted as an integer).</dd>
<dt><code>mount(<i>fs_type</i>, <i>partition_type</i>, <i>name</i>,
<i>mount_point</i>)</code></dt>
<dd>Mounts a filesystem of <i>fs_type</i> at <i>mount_point</i>.
<i>partition_type</i> must be one of:
<ul>
<li><b>MTD</b>. Name is the name of an MTD partition (e.g., system, userdata;
see <code>/proc/mtd</code> on the device for a complete list).</li>
<li><b>EMMC.</b></li>
</ul>
<p>Recovery does not mount any filesystems by default (except the SD card if
the user is doing a manual install of a package from the SD card); your script
must mount any partitions it needs to modify.</p></dd>
<dt><code>package_extract_dir(<i>package_dir</i>, <i>dest_dir</i>)</code></dt>
<dd>Extracts all files from the package underneath <i>package_dir</i> and
writes them to the corresponding tree beneath <i>dest_dir</i>. Any existing
files are overwritten.</dd>
<dt><code>package_extract_file(<i>package_file</i>[, <i>dest_file</i>])</code>
</dt>
<dd>Extracts a single <i>package_file</i> from the update package and writes
it to <i>dest_file</i>, overwriting existing files if necessary. Without the
<i>dest_file</i> argument, returns the contents of the package file as a
binary blob.</dd>
<dt><code>read_file(<i>filename</i>)</code></dt>
<dd>Reads <i>filename</i> and returns its contents as a binary blob.</dd>
<dt><code>rename(<i>src_filename</i>, <i>tgt_filename</i>)</code></dt>
<dd>Renames <i>src_filename</i> to <i>tgt_filename</i>. It automatically creates
the necessary directories for the <i>tgt_filename</i>. Example: <code>
rename("system/app/Hangouts/Hangouts.apk",
"system/priv-app/Hangouts/Hangouts.apk")</code>.</dd>
<dt><code>run_program(<i>path</i>[, <i>arg</i>, ...])</code></dt>
<dd>Executes the binary at <i>path</i>, passing <i>arg</i>s. Returns the
program's exit status.</dd>
<dt><code>set_metadata(<i>filename</i>, <i>key1</i>, <i>value1</i>[, <i>key2
</i>, <i>value2</i>, ...])</code></dt>
<dd>Sets the keys of the given <i>filename</i> to <i>values</i>. For example:
<code>set_metadata("/system/bin/netcfg", "uid", 0, "gid", 3003, "mode", 02750,
"selabel", "u:object_r:system_file:s0", "capabilities", 0x0)</code>.</dd>
<dt><code>set_metadata_recursive(<i>dirname</i>, <i>key1</i>, <i>value1</i>[,
<i>key2</i>, <i>value2</i>, ...])</code></dt>
<dd>Recursively sets the keys of the given <i>dirname</i> and all its children
to <i>values</i>. For example: <code>set_metadata_recursive("/system", "uid",
0, "gid", 0, "fmode", 0644, "dmode", 0755, "selabel",
"u:object_r:system_file:s0", "capabilities", 0x0)</code>.</dd>
<dt><code>set_progress(<i>frac</i>)</code></dt>
<dd>Sets the position of the progress meter within the chunk defined by the
most recent <code>show_progress()</code> call. <i>frac</i> must be in the
range [0.0, 1.0]. The progress meter never moves backwards; attempts to make
it do so are ignored.</dd>
<dt><code>sha1_check(<i>blob</i>[, <i>sha1</i>])</code></dt>
<dd>The <i>blob</i> argument is a blob of the type returned by <code>
read_file()</code> or the one-argument form of <code>package_extract_file()
</code>. With no <i>sha1</i> arguments, this function returns the SHA1 hash of
the blob (as a 40-digit hex string). With one or more <i>sha1</i> arguments,
this function returns the SHA1 hash if it equals one of the arguments, or the
empty string if it does not equal any of them.</dd>
<dt><code>show_progress(<i>frac</i>, <i>secs</i>)</code></dt>
<dd>Advances the progress meter over the next <i>frac</i> of its length over
the <i>secs</i> seconds (must be an integer). <i>secs</i> may be 0, in which
case the meter is not advanced automatically but by use of the <code>
set_progress()</code> function defined above.</dd>
<dt><code>sleep(<i>secs</i>)</code></dt>
<dd>Sleeps for <i>secs</i> seconds (must be an integer).</dd>
<dt><code>stdout(<i>expr</i>[, <i>expr</i>, ...])</code></dt>
<dd>Evaluates each expression and dumps its value to stdout. Useful for
debugging.</dd>
<dt><code>symlink(<i>target</i>[, <i>source</i>, ...])</code></dt>
<dd>Creates all <i>source</i>s as symlinks to <i>target</i>.</dd>
<dt><code>tune2fs(<i>device</i>[, <i>arg</i>, …])</code></dt>
<dd>Adjusts tunable parameters <i>args</i> on <i>device</i>.</dd>
<dt><code>ui_print([<i>text</i>, ...])</code></dt>
<dd>Concatenates all <i>text</i> arguments and prints the result to the UI
(where it will be visible if the user has turned on the text display).</dd>
<dt><code>unmount(<i>mount_point</i>)</code></dt>
<dd>Unmounts the filesystem mounted at <i>mount_point</i>.</dd>
<dt><code>wipe_block_device(<i>block_dev</i>, <i>len</i>)</code></dt>
<dd>Wipes the <i>len</i> bytes of the given block device <i>block_dev</i>.</dd>
<dt><code>wipe_cache()</code></dt>
<dd>Causes the cache partition to be wiped at the end of a successful
installation.</dd>
<dt><code>write_raw_image(<i>filename_or_blob</i>, <i>partition</i>)</code>
</dt>
<dd>Writes the image in <i>filename_or_blob</i> to the MTD <i>partition</i>.
<i>filename_or_blob</i> can be a string naming a local file or a blob-valued
argument containing the data to write. To copy a file from the OTA package to
a partition, use:
<code>write_raw_image(package_extract_file("zip_filename"), "partition_name");
</code>
</dd>
</dl>

<p class="note"><strong>Note:</strong> Prior to Android 4.1, only filenames
were accepted, so to accomplish this the data first had to be unzipped into a
temporary local file.</p>

    </div>

      <div class="content-footer-sac"
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-9" style="padding-top:4px">
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>
      
      
    </div> <!-- end jd-content -->
  <div id="footer" class="wrap" >
  <style>.feedback { float: right !Important }</style>
  <div class="feedback">
    <a href="inside_packages.html#" class="button" onclick=" try {
      userfeedback.api.startFeedback({'productId':'715571','authuser':'1'});return false;}catch(e){}">Site Feedback</a>
  </div>
  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../../../license.html">Content 
  License</a>.
  </div>
    <div id="footerlinks">
    
  <p>
    <a href="../../../source/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../../source/community.html">Community</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
  </p>
  </div>

</div><!-- end doc-content -->

</div> <!-- end body-content --> 






</body>
</html>



