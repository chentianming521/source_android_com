<!DOCTYPE html>











































































































<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<meta name="Description" content="Android gives you the freedom to implement your own device specifications and drivers. The hardware abstraction layer (HAL) provides a standard method for creating software hooks between the Android platform stack and your hardware. The Android operatingâ€¦">

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
<title>Android Interfaces and Architecture | Android Open Source Project</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="https://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="../assets/css/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="https://www.google.com/jsapi" type="text/javascript"></script>
<script src="../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "/";
  
  var devsite = false;
  
</script>
<script src="../assets/js/docs.js" type="text/javascript"></script>

<script src="../navtree_data.js" type="text/javascript"></script>


<script type="text/javascript" src="https://www.gstatic.com/feedback/api.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45455297-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body class="gc-documentation 
  " itemscope itemtype="http://schema.org/Article">
<a name="top"></a>

  
    <!-- Header -->
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 saclogo">
          <a href="../index.html">
            <img src="../assets/images/sac_logo.png"
                srcset="/assets/images/sac_logo@2x.png 2x"
                width="123" height="25" alt="Android Open Source Project" />
          </a>
          </div>
            <ul class="nav-x col-9">
                <li class="source">
                  <a href="../source/index.html" 
                  >Source</a></li>
                <li class="devices"><a href="index.html" class="selected"
                  >Devices</a></li>
                <li class="security"><a href="../security/index.html" 
                  >Security</a></li>
                <li class="compatibility last"><a href="../compatibility/index.html" 
                  >Compatibility</a></li>
            </ul>
            <!-- New Search -->
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Android Sites</div>
      <ul>
        <li class="active"><a>Android Open Source Project</a></li>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li><a href="http://developer.android.com">Android Developers</a></li>
      </ul>
      <!-- <div class="header">Support</div>
      <ul>
        <li><a href="/support.html">Developer Support</a></li>
      </ul> -->
      <br class="clearfix" />
    </div>
    <div class="bottom"></div>
  </div>

  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
onkeydown="return search_changed(event, true, '/')"
onkeyup="return search_changed(event, false, '/')" />
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>
  <div id="search_filtered_wrapper">
    <div id="search_filtered_div" class="no-display">
        <ul id="search_filtered">
        </ul>
    </div>
  </div>

  </div>
  <!-- /New Search> -->
        </div>
    </div>
    <!-- /Header -->

  <div id="searchResults" class="wrap" style="display:none;">
          <h2 id="searchTitle">Results</h2>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div>

  
  
  
    
  <div class="wrap clearfix" id="body-content">
    <div class="col-4" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<a class="totop" href="index.html#top" data-g-event="left-nav-top">to top</a>

<!--
    Copyright 2015 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<ul id="nav">
  <li class="nav-section">  <!-- Begin nav section, Device Interfaces -->
    <div class="nav-section-header">
      <a href="index.html">
        <span class="en">Interfaces</span>
      </a>
    </div>
    <ul>
  <li class="nav-section">
  <div class="nav-section-header">
      <a href="accessories/index.html">
        <span class="en">Accessories</span>
      </a>
    </div>
    <ul>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="accessories/audio.html">
            <span class="en">Audio Accessories</span>
          </a>
        </div>
        <ul>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="accessories/headset/index.html">
            <span class="en">Headset</span>
          </a>
        </div>
        <ul>
          <li><a href="accessories/headset/specification.html">Specification</a></li>
          <li><a href="accessories/headset/requirements.html">Requirements</a></li>
          <li><a href="accessories/headset/testing.html">Testing</a></li>
        </ul>
      </li>
        </ul>
      </li>
  <li class="nav-section">
  <div class="nav-section-header">
      <a href="accessories/custom.html">
        <span class="en">Custom Accessories</span>
      </a>
    </div>
    <ul>
      <li class="nav-section">
        <div class="nav-section-header"><a href="accessories/protocol.html"><span class="en">AOA</span>
        </a>
        </div>
        <ul>
          <li><a href="accessories/aoa2.html">AOA 2.0</a></li>
          <li><a href="accessories/aoa.html">AOA 1.0</a></li>
        </ul>
        </li>
        <div class="nav-section-header"><a href="accessories/stylus.html"><span class="en">Stylus</span>
        </a>
        </div>
       </ul>
     </li>
    </ul>
      <li class="nav-section">
      <div class="nav-section-header">
        <a href="audio/index.html">
          <span class="en">Audio</span>
        </a>
      </div>
        <ul>
          <li><a href="audio/terminology.html">Terminology</a></li>
          <li class="nav-section">
            <div class="nav-section-header">
              <a href="audio/implement.html">
                <span class="en">Implementation</span>
              </a>
            </div>
            <ul>
              <li><a href="audio/implement-policy.html">Policy Configuration</a></li>
              <li><a href="audio/implement-shared-library.html">Shared Library</a></li>
              <li><a href="audio/implement-pre-processing.html">Pre-processing Effects</a></li>
            </ul>
         </li>
          <li><a href="audio/data_formats.html">Data Formats</a></li>
          <li><a href="audio/attributes.html">Attributes</a></li>
          <li><a href="audio/warmup.html">Warmup</a></li>
          <li class="nav-section">
            <div class="nav-section-header">
              <a href="audio/latency.html">
                <span class="en">Latency</span>
              </a>
            </div>
            <ul>
              <li><a href="audio/latency_contrib.html">Contributors</a></li>
              <li><a href="audio/latency_design.html">Design</a></li>
              <li><a href="audio/latency_measure.html">Measure</a></li>
              <li><a href="audio/testing_circuit.html">Light Testing Circuit</a></li>
              <li><a href="audio/loopback.html">Audio Loopback Dongle</a></li>
              <li><a href="audio/latency_measurements.html">Measurements</a></li>
              <li><a href="audio/latency_app.html">Applications</a></li>
            </ul>
          </li>
          <li><a href="audio/avoiding_pi.html">Priority Inversion</a></li>
          <li><a href="audio/src.html">Sample Rate Conversion</a></li>
          <li><a href="audio/debugging.html">Debugging</a></li>
          <li class="nav-section">
            <div class="nav-section-header">
              <a href="audio/midi.html">
                <span class="em">MIDI</span>
              </a>
            </div>
            <ul>
              <li><a href="audio/midi_arch.html">MIDI Architecture</a></li>
              <li><a href="audio/midi_test.html">MIDI Test Procedure</a></li>
            </ul>
          <li><a href="audio/usb.html">USB Digital Audio</a></li>
          <li><a href="audio/tv.html">TV Audio</a></li>
        </ul>
      </li>
      <li><a href="automotive.html">Automotive</a></li>
      <li><a href="bluetooth.html">Bluetooth</a></li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="camera/index.html">
            <span class="en">Camera</span>
          </a>
        </div>
        <ul>
          <li><a href="camera/camera3.html">Camera HAL3</a></li>
          <li><a href="camera/camera3_requests_hal.html">HAL Subsystem</a></li>
          <li><a href="camera/camera3_metadata.html">Metadata and Controls</a></li>
          <li><a href="camera/camera3_3Amodes.html">3A Modes and State</a></li>
          <li><a href="camera/camera3_crop_reprocess.html">Output and Cropping</a></li>
          <li><a href="camera/camera3_error_stream.html">Errors and Streams</a></li>
          <li><a href="camera/camera3_requests_methods.html">Request Creation</a></li>
          <li><a href="camera/versioning.html">Version Support</a></li>
        </ul>
      </li>

      <li><a href="drm.html">DRM</a></li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="graphics/index.html">
            <span class="en">Graphics</span>
          </a>
        </div>
        <ul>
         <li class="nav-section">
            <div class="nav-section-header">
              <a href="graphics/architecture.html">
                <span class="en">Architecture</span>
              </a>
            </div>
            <ul>
              <li><a href="graphics/arch-bq-gralloc.html">BufferQueue</a></li>
              <li><a href="graphics/arch-sf-hwc.html">SurfaceFlinger and HWC</a></li>
              <li><a href="graphics/arch-sh.html">Surface and SurfaceHolder</a></li>
              <li><a href="graphics/arch-egl-opengl.html">OpenGL ES</a></li>
              <li><a href="graphics/arch-vulkan.html">Vulkan</a></li>
              <li><a href="graphics/arch-sv-glsv.html">SurfaceView</a></li>
              <li><a href="graphics/arch-st.html">SurfaceTexture</a></li>
              <li><a href="graphics/arch-tv.html">TextureView</a></li>
              <li><a href="graphics/arch-gameloops.html">Game Loops</a></li>
            </ul>
         </li>
         <li class="nav-section">
            <div class="nav-section-header">
              <a href="graphics/implement.html">
                <span class="en">Implementing</span>
              </a>
            </div>
            <ul>
              <li><a href="graphics/implement-hwc.html">Hardware Composer HAL</a></li>
              <li><a href="graphics/implement-vsync.html">VSYNC</a></li>
              <li><a href="graphics/implement-vulkan.html">Vulkan</a></li>
              <li><a href="graphics/implement-vdisplays.html">Virtual Displays</a></li>
            </ul>
         </li>
         <li class="nav-section">
            <div class="nav-section-header">
              <a href="graphics/testing.html">
                <span class="en">OpenGL ES Testing</span>
              </a>
            </div>
            <ul>
              <li><a href="graphics/build-tests.html">Building test programs</a></li>
              <li><a href="graphics/port-tests.html">Porting the test framework</a></li>
              <li><a href="graphics/run-tests.html">Running the tests</a></li>
              <li><a href="graphics/automate-tests.html">Automating the tests</a></li>
              <li><a href="graphics/test-groups.html">Using special test groups</a></li>
              <li><a href="graphics/cts-integration.html">Integrating with Android CTS</a></li>
            </ul>
         </li>
        </ul> </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="input/index.html">
            <span class="en">Input</span>
          </a>
        </div>
        <ul>
          <li><a href="input/overview.html">Overview</a></li>
          <li><a href="input/key-layout-files.html">Key Layout Files</a></li>
          <li><a href="input/key-character-map-files.html">Key Character Map Files</a></li>
          <li><a href="input/input-device-configuration-files.html">Input Device Configuration Files</a></li>
          <li><a href="input/migration-guide.html">Migration Guide</a></li>
          <li><a href="input/keyboard-devices.html">Keyboard Devices</a></li>
          <li><a href="tech/input/touch-devices.html">Touch Devices</a></li>
          <li><a href="tech/input/dumpsys.html">Diagnostics</a></li>
          <li><a href="input/getevent.html">Getevent</a></li>
          <li><a href="input/validate-keymaps.html">Validate Keymaps</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="media.html">
            <span class="en">Media</span>
          </a>
        </div>
        <ul>
          <li><a href="media/framework-hardening.html">Framework
          Hardening</a></li>
          <li><a href="media/soc.html">SoC Dependencies</a></li>
          <li><a href="media/oem.html">OEM Dependencies</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="sensors/index.html">
            <span class="en">Sensors</span>
          </a>
        </div>
        <ul>
          <li><a href="sensors/sensor-stack.html">Sensor stack</a></li>
          <li><a href="sensors/report-modes.html">Reporting modes</a></li>
          <li><a href="sensors/suspend-mode.html">Suspend mode</a></li>
          <li><a href="sensors/power-use.html">Power consumption</a></li>
          <li><a href="sensors/interaction.html">Interaction</span></a></li>
          <li><a href="sensors/hal-interface.html">HAL interface</a></li>
          <li><a href="sensors/batching.html">Batching</a></li>
          <li><a href="sensors/sensor-types.html">Sensor types</a></li>
          <li><a href="sensors/versioning.html">Version deprecation</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="https://source.android.com/devices/storage/index.html">
            <span class="en">Storage</span>
          </a>
        </div>
        <ul>
          <li><a href="storage/traditional.html">Traditional Storage</a></li>
          <li><a href="storage/adoptable.html">Adoptable Storage</a></li>
          <li><a href="storage/config.html">Device Configuration</a></li>
          <li><a href="storage/config-example.html">Configuration Examples</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tv/index.html">
            <span class="en">TV</span>
          </a>
        </div>
        <ul>
          <li><a href="tv/HDMI-CEC.html">HDMI-CEC control service</a></li>
          <li><a href="tv/reference-tv-app.html">Reference TV App</a></li>
        </ul>
      </li>
    </ul>
  </li> <!-- End nav-section, Device Interfaces-->


  <li class="nav-section"> <!--Begin nav-section, Core Technologies-->
    <div class="nav-section-header">
      <a href="tech/index.html">
        <span class="en">Core Technologies</span>
      </a>
    </div>

    <ul>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tech/dalvik/index.html">
          <span class="en">ART and Dalvik</span></a>
        </div>
        <ul>
          <li><a href="tech/dalvik/dalvik-bytecode.html">Bytecode Format</a></li>
          <li><a href="tech/dalvik/dex-format.html">.Dex Format</a></li>
          <li><a href="tech/dalvik/instruction-formats.html">Instruction Formats</a></li>
          <li><a href="tech/dalvik/constraints.html">Constraints</a></li>
          <li><a href="tech/dalvik/configure.html">Configuration</a></li>
          <li><a href="tech/dalvik/gc-debug.html">Garbage Collection</a></li>
          <li><a href="tech/dalvik/jit-compiler.html">JIT Compilation</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="tech/config/index.html">
              <span class="en">Configuration</span>
            </a>
        </div>
        <ul>
          <li><a href="tech/config/carrier.html">Carrier Customization</a></li>
          <li><a href="tech/config/connect_tests.html">Connectivity Tests</a></li>
          <li><a href="tech/config/filesystem.html">File System</a></li>
          <li><a href="tech/kernel.html">Kernel Configuration</a></li>
          <li><a href="tech/config/kernel_network_tests.html">Kernel Network Tests</a></li>
          <li><a href="tech/config/low-ram.html">Low RAM</a></li>
          <li><a href="tech/config/namespaces_libraries.html">Namespaces for Libraries</a></li>
          <li><a href="tech/config/renderer.html">OpenGLRenderer</a></li>
          <li><a href="tech/config/runtime_perms.html">Runtime Permissions</a></li>
          <li><a href="tech/config/uicc.html">UICC</a></li>
          <li><a href="tech/config/voicemail.html">Visual Voicemail</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="tech/connect/index.html">
              <span class="en">Connectivity</span>
            </a>
        </div>
        <ul>
          <li><a href="tech/connect/block-numbers.html">Block Phone Numbers</a></li>
          <li><a href="tech/connect/call-notification.html">Call Notifications</a></li>
          <li><a href="tech/connect/data-saver.html">Data Saver Mode</a></li>
          <li><a href="tech/connect/felica.html">Host Card Emulation of FeliCa</a></li>
          <li><a href="tech/connect/ril.html">Radio Interface Layer (RIL)</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tech/datausage/index.html">
            <span class="en">Data Usage</span>
          </a>
        </div>
        <ul>
          <li><a href="tech/datausage/iface-overview.html">Network interface statistics overview</a></li>
          <li><a href="tech/datausage/excluding-network-types.html">Excluding Network Types from Data Usage</a></li>
          <li><a href="tech/datausage/tethering-data.html">Tethering Data</a></li>
          <li><a href="tech/datausage/usage-cycle-resets-dates.html">Usage Cycle Reset Dates</a></li>
          <li><a href="tech/datausage/kernel-overview.html">Kernel Overview</a></li>
          <li><a href="tech/datausage/tags-explained.html">Data Usage Tags Explained</a></li>
          <li><a href="tech/datausage/kernel-changes.html">Kernel Changes</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tech/debug/index.html">
            <span class="en">Debugging</span>
          </a>
        </div>
        <ul>
          <li><a href="tech/debug/asan.html">AddressSanitizer</a></li>
          <li><a href="tech/debug/dumpsys.html">Dumpsys</a></li>
          <li><a href="tech/debug/native-memory.html">Native Memory Use</a></li>
          <li><a href="tech/debug/netstats.html">Network Use</a></li>
          <li><a href="tech/debug/procstats.html">RAM Use</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tech/admin/index.html">
          <span class="en">Device Administration</span></a>
        </div>
        <ul>
          <li><a href="tech/admin/implement.html">Implementation</a></li>
          <li><a href="tech/admin/multi-user.html">Multiple Users</a></li>
          <li><a href="tech/admin/managed-profiles.html">Managed Profiles</a></li>
          <li><a href="tech/admin/provision.html">Provisioning</a></li>
          <li><a href="tech/admin/multiuser-apps.html">Multiuser Apps</a></li>
          <li><a href="tech/admin/enterprise-telephony.html">Enterprise Telephony</a></li>
          <li><a href="tech/admin/testing-provision.html">Testing Device Provisioning</a></li>
          <li><a href="tech/admin/testing-setup.html">Testing Device Administration</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="tech/display/index.html">
              <span class="en">Display Settings</span></a>
        </div>
        <ul>
          <li><a href="tech/display/dnd.html">Do Not Disturb</a></li>
          <li><a href="tech/display/multi-window.html">Multi-Window</a></li>
          <li><a href="tech/display/hdr.html">HDR Video</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header empty">
          <a href="halref/index.html">
            <span class="en">HAL File Reference</span>
          </a>
        </div>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
            <a href="tech/ota/index.html">
              <span class="en">OTA Updates</span>
            </a>
        </div>
        <ul>
          <li><a href="tech/ota/tools.html">OTA Tools</a></li>
          <li><a href="tech/ota/block.html">Block-based OTA</a></li>
          <li><a href="tech/ota/inside_packages.html">Inside OTA Packages</a></li>
          <li><a href="tech/ota/device_code.html">Device-Specific Code</a></li>
          <li><a href="tech/ota/reduce_size.html">Reducing OTA Size</a></li>
          <li><a href="tech/ota/sign_builds.html">Signing Builds for Release</a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tech/power/index.html"><span class="en">Power</span></a>
        </div>
        <ul>
          <li><a href="tech/power/mgmt.html">Power Management</a></li>
          <li><a href="tech/power/performance.html">Performance Management</a></li>
          <li><a href="tech/power/component.html">Component Power</a></li>
          <li><a href="tech/power/device.html">Device Power</a></li>
          <li><a href="tech/power/values.html">Power Values</a></li>
          <li><a href="tech/power/batterystats.html">Battery Use</a>
          </li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header">
          <a href="tech/test_infra/tradefed/index.html">
            <span class="en">Testing Infrastructure</span>
          </a>
        </div>
        <ul>
          <li><a href="tech/test_infra/tradefed/fundamentals/index.html">Start Here</a></li>
          <li><a href="tech/test_infra/tradefed/fundamentals/machine_setup.html">Machine Setup</a></li>
          <li><a href="tech/test_infra/tradefed/fundamentals/devices.html">Working with Devices</a></li>
          <li><a href="tech/test_infra/tradefed/fundamentals/lifecycle.html">Test Lifecycle</a></li>
          <li><a href="tech/test_infra/tradefed/fundamentals/options.html">Option Handling</a></li>
          <li><a href="tech/test_infra/tradefed/full_example.html">An End-to-End Example</a></li>
          <li id="tradefed-tree-list" class="nav-section">
            <div class="nav-section-header">
              <a href="../reference/packages.html">
                <span class="en">Package Index</span>
              </a>
            </div>
          </li>
        </ul>
      </li>
    </ul>
  </li> <!-- End nav-section, Core Technologies -->
</ul> 


      </div>
      <script type="text/javascript">
        showTradefedRefTree();
      </script>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>

  




<div class="col-12" id="doc-col" >


  
    
      
        <h1 itemprop="name" >Android Interfaces and Architecture</h1>
      
    
  


  
  <div id="jd-content">

    <div class="jd-descr" itemprop="articleBody">
    <!--
    Copyright 2015 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<div id="qv-wrapper">
  <div id="qv">
    <h2>In this document</h2>
    <ol id="auto-toc">
    </ol>
  </div>
</div>

<p>
Android gives you the freedom to implement your own device specifications and
drivers. The hardware abstraction layer (HAL) provides a standard method for
creating software hooks between the Android platform stack and your hardware.
The Android operating system is also open source, so you can contribute your own
interfaces and enhancements.
</p>

<p>
To ensure devices maintain a high level of quality and offer a consistent user
experience, each device must pass tests in the compatibility test suite (CTS).
The CTS verifies devices meet a quality standard that ensures apps run reliably
and users have a good experience. For details on the CTS, see
<a href="../compatibility/index.html">Compatibility</a>.
</p>

<p>
Before porting Android to your hardware, take a moment to understand the Android
system architecture at a high level. Because your drivers and the HAL interact
with Android, knowing how Android works can help you navigate the many layers of
code in the Android Open Source Project (AOSP) source tree.
</p>

<img src="images/ape_fwk_all.png">

<p class="img-caption"><strong>Figure 1.</strong> Android System Architecture</p>

<h2 id="Application framework">Application framework</h2>
<p>
The application framework is used most often by application developers. As a
hardware developer, you should be aware of developer APIs as many map directly
to the underlying HAL interfaces and can provide helpful information about
implementing drivers.
</p>

<h2 id="Binder IPC">Binder IPC</h2>
<p>
The Binder Inter-Process Communication (IPC) mechanism allows the application
framework to cross process boundaries and call into the Android system services
code. This enables high level framework APIs to interact with Android system
services. At the application framework level, this communication is hidden from
the developer and things appear to "just work."
</p>

<h2 id="System services">System services</h2>
<p>
Functionality exposed by application framework APIs communicates with system
services to access the underlying hardware. Services are modular, focused
components such as Window Manager, Search Service, or Notification Manager.
Android includes two groups of services: <em>system</em> (services such as
Window Manager and Notification Manager) and <em>media</em> (services involved
in playing and recording media).
</p>

<h2 id="Hardware Abstraction Layer">Hardware abstraction layer (HAL)</h2>
<p>
The hardware abstraction layer (HAL) defines a standard interface for hardware
vendors to implement and allows Android to be agnostic about lower-level driver
implementations. The HAL allows you to implement functionality without
affecting or modifying the higher level system. HAL implementations are
packaged into modules (<code>.so</code>) file and loaded by the Android system
at the appropriate time.
</p>

<img src="images/ape_fwk_hal.png">

<p class="img-caption"><strong>Figure 2.</strong> Hardware abstraction layer
(HAL) components</p>

<p>
You must implement the corresponding HAL (and driver) for the specific hardware
your product provides. HAL implementations are typically built into shared
library modules (<code>.so</code> files). Android does not mandate a standard
interaction between your HAL implementation and your device drivers, so you have
free reign to do what is best for your situation. However, to enable the Android
system to correctly interact with your hardware, you <strong>must</strong> abide
by the contract defined in each hardware-specific HAL interface.
</p>

<h3 id="structure">Standard HAL structure</h3>
<p>
  Each hardware-specific HAL interface has properties that are defined in
  <code>hardware/libhardware/include/hardware/hardware.h</code>, which
  guarantee that HALs have a predictable structure.
  This interface allows the Android system to load the correct versions of your
  HAL modules in a consistent way. There are two general components
  that a HAL interface consists of: a module and a device.
</p>
<p>
  A module represents your packaged HAL implementation, which is stored as a shared library (<code>.so file</code>). It contains
  metadata such as the version, name, and author of the module, which helps Android find and load it correctly. The
  <code>hardware/libhardware/include/hardware/hardware.h</code> header file defines a
  struct, <code>hw_module_t</code>, that represents a module and contains information such as
  the module version, author, and name.</p>

  <p>In addition, the <code>hw_module_t</code> struct contains
  a pointer to another struct, <code>hw_module_methods_t</code>, that contains a pointer to
  an "open" function for the module. This open function is used to initiate communication with
  the hardware that the HAL is serving as an abstraction for. Each hardware-specific HAL usually
  extends the generic <code>hw_module_t</code> struct with additional information
  for that specific piece of hardware. For example in the camera HAL, the <code>camera_module_t</code> struct
  contains a <code>hw_module_t</code> struct along with other camera-specific function pointers:
</p>

<pre>
typedef struct camera_module {
    hw_module_t common;
    int (*get_number_of_cameras)(void);
    int (*get_camera_info)(int camera_id, struct camera_info *info);
} camera_module_t;
</pre>

<p>When you implement a HAL and create the module struct, you must name it
  <code>HAL_MODULE_INFO_SYM</code>. For instance, here is an example from the Nexus 9 audio HAL:</p>
<pre>
struct audio_module HAL_MODULE_INFO_SYM = {
    .common = {
        .tag = HARDWARE_MODULE_TAG,
        .module_api_version = AUDIO_MODULE_API_VERSION_0_1,
        .hal_api_version = HARDWARE_HAL_API_VERSION,
        .id = AUDIO_HARDWARE_MODULE_ID,
        .name = "NVIDIA Tegra Audio HAL",
        .author = "The Android Open Source Project",
        .methods = &hal_module_methods,
    },
};
</pre>
<p>
  A device abstracts the actual hardware of your product. For example, an audio module can contain
  a primary audio device, a USB audio device, or a Bluetooth A2DP audio device. A device
  is represented by the <code>hw_device_t</code> struct. Like a module, each type of device
  defines a more-detailed version of the generic <code>hw_device_t</code> that contains
  function pointers for specific features of the hardware. For example, the
  <code>audio_hw_device_t</code> struct type contains function pointers to audio device operations:
</p>

<pre>
struct audio_hw_device {
    struct hw_device_t common;

    /**
     * used by audio flinger to enumerate what devices are supported by
     * each audio_hw_device implementation.
     *
     * Return value is a bitmask of 1 or more values of audio_devices_t
     */
    uint32_t (*get_supported_devices)(const struct audio_hw_device *dev);
  ...
};
typedef struct audio_hw_device audio_hw_device_t;
</pre>

<p>
  In addition to these standard properties, each hardware-specific HAL interface can define more of its
  own features and requirements. See the <a href="halref/index.html">HAL reference documentation</a>
  as well as the individual instructions for each HAL for more information on how to implement a specific interface.
</p>

<h3 id="modules">HAL modules</h3>
<p>HAL implementations are built into modules (<code>.so</code>) files and are dynamically linked by Android when appropriate.
  You can build your modules by creating <code>Android.mk</code> files for each of your HAL implementations
  and pointing to your source files. In general, your shared libraries must be named in a certain format, so that
  they can be found and loaded properly. The naming scheme varies slightly from module to module, but they follow
  the general pattern of: <code>&lt;module_type&gt;.&lt;device_name&gt;</code>.</p>

  <p>For more information about setting up the build for each HAL, see its respective documentation.</p>

<h2 id="Linux kernel">Linux kernel</h2>
<p>
Developing your device drivers is similar to developing a typical Linux device
driver. Android uses a version of the Linux kernel with a few special additions
such as wake locks (a memory management system that is more aggressive in
preserving memory), the Binder IPC driver, and other features important for a
mobile embedded platform. These additions are primarily for system functionality
and do not affect driver development.

<p>
You can use any version of the kernel as long as it supports the required
features (such as the binder driver). However, we recommend using the latest
version of the Android kernel. For details on the latest Android kernel, see <a href="../source/building-kernels.html" >Building Kernels</a>.
</p>

    </div>

      <div class="content-footer-sac"
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-9" style="padding-top:4px">
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>
      
      
    </div> <!-- end jd-content -->
  <div id="footer" class="wrap" >
  <style>.feedback { float: right !Important }</style>
  <div class="feedback">
    <a href="index.html#" class="button" onclick=" try {
      userfeedback.api.startFeedback({'productId':'715571','authuser':'1'});return false;}catch(e){}">Site Feedback</a>
  </div>
  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../license.html">Content 
  License</a>.
  </div>
    <div id="footerlinks">
    
  <p>
    <a href="../source/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../source/community.html">Community</a>&nbsp;&nbsp;|&nbsp;
    <a href="../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
  </p>
  </div>

</div><!-- end doc-content -->

</div> <!-- end body-content --> 






</body>
</html>



